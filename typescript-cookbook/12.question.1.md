# 12.6ì ˆ ì¸ë±ìŠ¤ ì ‘ê·¼ ì œí•œ - ì‹¬í™” ì •ë¦¬

## ë¬¸ì œ ìƒí™©

```typescript
let myCar = {
  brand: 'Toyota',
  model: 'Corolla',
  year: 2020,
};
type CarType = typeof myCar;

const changeCar = (from: CarType, to: CarType) => {
  for (const key in from) {
    to[key] = from[key];  // âŒ ì˜¤ë¥˜: 'string | number'ëŠ” 'never'ì— í• ë‹¹ ë¶ˆê°€
  }
};
```

---

## ì™œ neverê°€ ë˜ëŠ”ê°€?

`key`ê°€ `"brand" | "model" | "year"` **ìœ ë‹ˆì˜¨**ì¼ ë•Œ:

- `brand`, `model` â†’ `string`
- `year` â†’ `number`

TypeScriptëŠ” **ì“°ê¸° ì‘ì—…**ì—ì„œ ëª¨ë“  ê²½ìš°ì— ì•ˆì „í•œ ê°’ì„ ì°¾ê¸° ìœ„í•´ **ì¸í„°ì„¹ì…˜**ì„ ê³„ì‚°í•©ë‹ˆë‹¤:

```
string & number = never
```

---

## í•µì‹¬: ê³µë³€ì„±(Covariance) vs ë°˜ê³µë³€ì„±(Contravariance)

### ì½ê¸°(r-value) vs ì“°ê¸°(l-value)

```typescript
type CarType = { brand: string; model: string; year: number };
declare const key: keyof CarType;  // "brand" | "model" | "year"

// r-value (ì½ê¸°) - ê³µë³€ì„± â†’ ìœ ë‹ˆì˜¨
const value = car[key];  // string | number
// "ë­ê°€ ë‚˜ì˜¬ì§€ ëª¨ë¥´ë‹ˆê¹Œ ê°€ëŠ¥í•œ ê²ƒë“¤ì˜ í•©ì§‘í•©"

// l-value (ì“°ê¸°) - ë°˜ê³µë³€ì„± â†’ ì¸í„°ì„¹ì…˜
car[key] = ???;  // string & number = never
// "ë­ê°€ ë“¤ì–´ê°ˆì§€ ëª¨ë¥´ë‹ˆê¹Œ ëª¨ë“  ê²½ìš°ì— ì•ˆì „í•´ì•¼ í•¨ = êµì§‘í•©"
```

### ë³€ì„± ì •ë¦¬

| ìœ„ì¹˜ | ë³€ì„± | ê³„ì‚° | ì´ìœ  |
|------|------|------|------|
| **ì½ê¸° (ì¶œë ¥, r-value)** | ê³µë³€ì„± | ìœ ë‹ˆì˜¨ (`\|`) | ì–´ë–¤ ê°’ì´ **ë‚˜ì˜¬ì§€** ëª¨ë¦„ |
| **ì“°ê¸° (ì…ë ¥, l-value)** | ë°˜ê³µë³€ì„± | ì¸í„°ì„¹ì…˜ (`&`) | ì–´ë–¤ ê°’ì„ **ë°›ì„ì§€** ëª¨ë¦„ |

### ë¹„ìœ 

```
ğŸšª ë¬¸ A (brand): stringë§Œ í†µê³¼
ğŸšª ë¬¸ B (model): stringë§Œ í†µê³¼
ğŸšª ë¬¸ C (year): numberë§Œ í†µê³¼

Q: ì–´ë–¤ ë¬¸ì´ ì—´ë¦´ì§€ ëª¨ë¥¼ ë•Œ, ì–´ë–¤ ê°’ì„ ë„£ì–´ì•¼ í• ê¹Œ?
A: string AND numberì¸ ê°’ â†’ ê·¸ëŸ° ê°’ ì—†ìŒ! (never)
```

### í•¨ìˆ˜ì—ì„œì˜ ë™ì¼í•œ ì›ë¦¬

```typescript
type Fn = (input: string | number) => string | number;
//         â†‘ ì…ë ¥(ë§¤ê°œë³€ìˆ˜): ë°˜ê³µë³€    â†‘ ì¶œë ¥(ë°˜í™˜ê°’): ê³µë³€
```

- í•¨ìˆ˜ **ë§¤ê°œë³€ìˆ˜** ìœ„ì¹˜ = ë°˜ê³µë³€ì  (ì…ë ¥ë°›ëŠ” ê³³)
- í•¨ìˆ˜ **ë°˜í™˜ê°’** ìœ„ì¹˜ = ê³µë³€ì  (ì¶œë ¥í•˜ëŠ” ê³³)

---

## í•´ê²°ì±… 1: ì œë„¤ë¦­ìœ¼ë¡œ í‚¤ ê³ ì • (12.6ì ˆ íŒ¨í„´)

```typescript
function copyProperty<K extends keyof CarType>(
  from: CarType,
  to: CarType,
  key: K
): void {
  to[key] = from[key];  // âœ… Kê°€ íŠ¹ì • í‚¤ë¡œ ê³ ì •ë˜ì–´ ë™ì‘!
}

const changeCar = (from: CarType, to: CarType) => {
  const keys: (keyof CarType)[] = ['brand', 'model', 'year'];
  keys.forEach((key) => copyProperty(from, to, key));
};
```

### ì›ë¦¬

```typescript
copyProperty(from, to, "brand");
// K = "brand"ë¡œ ê³ ì •ë¨

// to["brand"] = from["brand"]
// l-value: string (brandì˜ íƒ€ì…)
// r-value: string (brandì˜ íƒ€ì…)
// â†’ ì¼ì¹˜! âœ…
```

ìœ ë‹ˆì˜¨ì´ ì•„ë‹ˆë¼ **íŠ¹ì • í‚¤ í•˜ë‚˜**ë¡œ ê³ ì •ë˜ì–´ì„œ ì¸í„°ì„¹ì…˜ ë¬¸ì œê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.

---

## í•´ê²°ì±… 2: Object.assign

### ë¶ˆë³€ì„± X (ì›ë³¸ ìˆ˜ì •)

```typescript
const changeCarMutable = <T extends object>(from: T, to: T): void => {
  Object.assign(to, from);  // toê°€ ì§ì ‘ ìˆ˜ì •ë¨
};
```

### ë¶ˆë³€ì„± O (ìƒˆ ê°ì²´ ë°˜í™˜)

```typescript
const changeCarImmutable = <T extends object>(from: T, to: T): T => {
  return Object.assign({}, to, from);  // ìƒˆ ê°ì²´ ë°˜í™˜
};
```

### ì›ë¦¬

- `Object.assign`ì˜ íƒ€ì… ì •ì˜ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬ë¨
- ìš°ë¦¬ê°€ ì§ì ‘ ì¸ë±ìŠ¤ ì ‘ê·¼ì„ í•˜ì§€ ì•Šì•„ì„œ ë¬¸ì œ íšŒí”¼

---

## í•´ê²°ì±… 3: í•¨ìˆ˜í˜• ìŠ¤íƒ€ì¼ (reduce)

```typescript
const changeCarFunctional = <T extends object>(from: T, to: T): T => {
  return Object.entries(from).reduce(
    (acc, [key, value]) => ({ ...acc, [key]: value }),
    { ...to }
  ) as T;
};
```

### ì£¼ì˜: `as T`ê°€ í•„ìš”í•œ ì´ìœ 

`Object.entries`ì˜ ë°˜í™˜ íƒ€ì…ì´ `[string, unknown][]`ì´ë¼ì„œ TypeScriptê°€ ì •í™•í•œ íƒ€ì…ì„ ì¶”ë¡ í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ì´ëŠ” TypeScriptì˜ í•œê³„ì…ë‹ˆë‹¤.

### íƒ€ì… í—¬í¼ë¡œ `as`ë¥¼ í•œ ê³³ì— ê²©ë¦¬

```typescript
const typedEntries = <T extends object>(obj: T): [keyof T, T[keyof T]][] => {
  return Object.entries(obj) as [keyof T, T[keyof T]][];
};

const changeCarFunctional = <T extends object>(from: T, to: T): T => {
  return typedEntries(from).reduce(
    (acc, [key, value]) => ({ ...acc, [key]: value }),
    { ...to } as T
  );
};
```

---

## í•´ê²°ì±… ë¹„êµ

| ë°©ì‹ | íŠ¹ì§• | ë¶ˆë³€ì„± | ê¶Œì¥ |
|------|------|--------|------|
| ì œë„¤ë¦­ í—¬í¼ | 12.6ì ˆ íŒ¨í„´ ì´í•´ìš© | âŒ | í•™ìŠµìš© |
| `Object.assign(to, from)` | ê°„ê²°, ì›ë³¸ ìˆ˜ì • | âŒ | ì‹¤ë¬´ (mutation OK) |
| `Object.assign({}, to, from)` | ê°„ê²°, ìƒˆ ê°ì²´ | âœ… | ì‹¤ë¬´ (ê¶Œì¥) |
| `reduce` + `entries` | í•¨ìˆ˜í˜•, ì²´ì´ë‹ ê°€ëŠ¥ | âœ… | ë³€í™˜ ë¡œì§ í•„ìš”ì‹œ |

---

## ìš”ì•½ ë‹¤ì´ì–´ê·¸ë¨

```
key: "brand" | "model" | "year" (ìœ ë‹ˆì˜¨)
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì½ê¸° (r-value) - ê³µë³€ì„±                â”‚
â”‚  â†’ "ë­ê°€ ë‚˜ì˜¬ì§€ ëª¨ë¦„"                   â”‚
â”‚  â†’ string | number (ìœ ë‹ˆì˜¨)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì“°ê¸° (l-value) - ë°˜ê³µë³€ì„±              â”‚
â”‚  â†’ "ëª¨ë“  ê²½ìš°ì— ì•ˆì „í•´ì•¼ í•¨"            â”‚
â”‚  â†’ string & number = never (ì¸í„°ì„¹ì…˜)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•´ê²°: ì œë„¤ë¦­ìœ¼ë¡œ Kë¥¼ íŠ¹ì • í‚¤ í•˜ë‚˜ë¡œ ê³ ì •
      â†’ ìœ ë‹ˆì˜¨ì´ ì•„ë‹˜ â†’ ì¸í„°ì„¹ì…˜ ë¬¸ì œ ì—†ìŒ!
```
